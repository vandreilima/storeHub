<div class="grid-2">
  <section class="default-gradient section-sapce">
    <div class="text-layout">
      <h1 class="text-h1">
        {{ "auth.forgot_password_title" | translate }}
      </h1>
      <p
        class="text-h4 c-neutral-100"
        [innerHTML]="
          'auth.forgot_password_description' | translate : {} : 'c-neutral-900'
        "
      ></p>

      <span class="text-h5 c-neutral-100">{{
        "auth.forgot_password_call_to_action" | translate
      }}</span>
    </div>
  </section>

  <section class="section-sapce">
    <p-card class="form-container">
      <ng-template #title>
        <h2 class="text-h2" style="margin: 0">
          {{ "auth.forgot_password_title" | translate }}
        </h2>
      </ng-template>
      <ng-template #subtitle>
        <h2 class="text-h5" style="margin: 0">
          {{ "auth.forgot_password_subtitle" | translate }}
        </h2>
      </ng-template>

      @if (!isEmailSent()) {
      <!-- Formulário de envio de e-mail -->
      <form [formGroup]="forgotPasswordForm" (ngSubmit)="onSubmit()">
        <div class="form-grid">
          <!-- Email -->
          <div class="form-field">
            <label for="email">{{ "auth.email" | translate }}</label>
            <input
              pInputText
              id="email"
              type="email"
              formControlName="email"
              [placeholder]="'auth.email_placeholder' | translate"
              [invalid]="
                forgotPasswordForm.get('email')?.invalid &&
                forgotPasswordForm.get('email')?.touched
              "
            />
            @if (forgotPasswordForm.get('email')?.invalid &&
            forgotPasswordForm.get('email')?.touched) {
            <p-message severity="error" size="small" variant="simple">
              @if (forgotPasswordForm.get('email')?.hasError('required')) {
              {{ "forms.required_field" | translate }}
              } @if (forgotPasswordForm.get('email')?.hasError('email')) {
              {{ "forms.invalid_email" | translate }}
              }
            </p-message>
            }
          </div>
        </div>

        @if (errorMessage()) {
        <p-message
          severity="error"
          [text]="errorMessage()"
          styleClass="mb-3"
        ></p-message>
        }

        <div class="form-actions">
          <p-button
            type="submit"
            [label]="'auth.send_reset_link' | translate"
            [loading]="isLoading"
            [disabled]="forgotPasswordForm.invalid || isLoading"
          ></p-button>
        </div>

        <div class="form-actions">
          <a routerLink="/sigin-in">
            <p-button link>
              {{ "auth.back_to_login" | translate }}
            </p-button>
          </a>
        </div>
      </form>
      } @else {
      <!-- Confirmação de e-mail enviado -->
      <div class="email-sent-container">
        <div class="success-icon">
          <i class="pi pi-check-circle"></i>
        </div>

        <h3 class="text-h3 text-center mb-4">
          {{ "auth.reset_email_sent" | translate }}
        </h3>

        <p class="text-center mb-6">
          {{ "auth.reset_email_sent_message" | translate }}
        </p>

        <div class="form-actions">
          <p-button
            [label]="'auth.check_email' | translate"
            icon="pi pi-envelope"
            [loading]="isLoading"
          ></p-button>
        </div>

        <div class="form-actions">
          <p-button
            [label]="'auth.resend_email' | translate"
            severity="secondary"
            [loading]="isLoading"
            (onClick)="resendEmail()"
          ></p-button>
        </div>

        <div class="form-actions">
          <a routerLink="/sigin-in">
            <p-button link>
              {{ "auth.back_to_login" | translate }}
            </p-button>
          </a>
        </div>
      </div>
      }
    </p-card>
  </section>
</div>
